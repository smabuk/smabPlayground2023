<div id="labyrinth">
	<div class="row">
		<button class="btn btn-primary" type="button" @onclick="() => StartNewGame()">@(GameOver ? "CONGRATULATIONS - New Game" : "New Game")</button>
	</div>
	@if (Game is not null) {
		<div id="board">
			@for (int r = -1; r <= Game.BoardSize; r++) {
				@for (int c = -1; c <= Game.BoardSize; c++) {
					(int col, int row) = (c, r);
					BoardPosition pos = grid[col, row];
					@if (pos is ExtraMazeTile extra) {
						<ExtraMazeTilePiece MazeTile="extra.MazeTile" OnContextMenu="Game.RotateAntiClockwise" OnClick="Game.RotateClockwise" />
					} else if (pos is PushableMazeTile) {
						<PushTile MazeTile="Game.Board.ExtraMazeTile" Push="() => Game.PushTheTile(col, row)" />
					} else if (pos is EmptyBoardTile) {
						<div />
					} else if (pos is BoardMazeTile tile) {
						<MazeTilePiece MazeTile="tile.MazeTile" />
					}
				}
			}
		</div>
	}
</div>

@code {
	public LabyrinthGame Game { get; set; } = null!;

	BoardPosition[,] grid => Game.GetMazeTilesAsGrid();
	bool GameOver = false;

	void StartNewGame() => Game = new();
}
